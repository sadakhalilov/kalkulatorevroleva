<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–ï–≤—Ä–æ-–ö–∞—Å–∞ 2026</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23d4af37%22>‚Ç¨</text></svg>">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
:root{
  --primary:#00264d; --accent:#d4af37; --bg:#f2f2f2; --error:#dc3545; --ok:#28a745;
  --eur:#28a745; --bgn:#007bff;
  --font-size:20px;
}
*{box-sizing:border-box;}
body{margin:0;font-family:Arial, sans-serif;background:var(--bg);display:flex;justify-content:center;padding:8px}
.container{background:#fff;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.15);width:100%;max-width:480px;padding:16px}

/* –õ–û–ì–û –°–¢–ò–õ –í –°–¢–†–ê–ù–ò–¶–ê–¢–ê */
.logo-circle {
  width: 60px; height: 60px; background: var(--primary); color: var(--accent);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-size: 40px; font-weight: bold; margin: 0 auto 10px; border: 2px solid var(--accent);
}

h2{margin:0 0 15px;text-align:center;color:var(--primary);font-size:24px; font-weight: 800; border-bottom: 2px solid var(--accent); padding-bottom: 5px;}
label{font-weight:600;font-size:12px;display:block;margin-bottom:4px}
input[type=number],input[type=text]{width:100%;font-size:var(--font-size);padding:12px;border:2px solid #ccc;border-radius:6px;text-align:right;margin-bottom:10px;}
.eur-input{border-color:var(--eur);background:#f0fff4}
.bgn-input{border-color:var(--bgn);background:#f0f8ff}

#banknoteArea{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:12px}
.money-btn{width:100%;padding:14px;border:none;border-radius:6px;font-weight:bold;font-size:1.1rem;cursor:pointer;transition:0.2s}
.eur-5{background:#b0bec5;} .eur-10{background:#ff8a80;} .eur-20{background:#90caf9;} 
.eur-50{background:#ffcc80;} .eur-100{background:#a5d6a7;} .eur-200{background:#e0e0e0;}
.bgn-5{background:#4fc3f7;} .bgn-10{background:#7986cb;} .bgn-20{background:#3f51b5;color:#fff;}
.bgn-50{background:#ffb74d;} .bgn-100{background:#e57373;}

.toggle-line{display:flex;justify-content:center;gap:8px;margin-bottom:8px}
.toggle-line button{flex:1;padding:10px;border:2px solid;border-radius:6px;background:#fff;font-weight:600;cursor:pointer}
.toggle-line button.active{background:var(--primary);color:#fff}

.result-zone{background:var(--primary);color:#fff;padding:16px;border-radius:8px;text-align:center;margin:12px 0}
.result-value{font-size:38px;font-weight:bold;color:var(--accent)}

.change-toggle{display:flex;justify-content:center;gap:8px;margin:8px 0}
.change-toggle button{flex:1;padding:10px;border:1px solid #fff;border-radius:6px;background:transparent;color:#fff;font-weight:600;cursor:pointer;font-size:12px}
.change-toggle button.active{background:#fff;color:var(--primary)}

.button-group{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
button.action-btn{padding:14px;border:none;border-radius:6px;font-size:15px;font-weight:600;cursor:pointer;color:#fff;}
.btn-save{background:var(--ok)} .btn-print{background:var(--primary)}

.history-table{width:100%;font-size:11px;border-collapse:collapse;margin-top:10px}
.history-table th,.history-table td{border:1px solid #ddd;padding:6px;text-align:center}
.history-table th{background:var(--primary);color:#fff}

.admin-toggle{position:fixed;bottom:10px;right:10px;opacity:.3;background:none;border:none;font-size:24px;cursor:pointer}
#adminPanel{display:none;position:fixed;inset:0;background:rgba(0,0,0,.95);color:#fff;padding:20px;z-index:100;overflow-y:auto}
.admin-box{background:#222;padding:15px;border-radius:8px;margin-bottom:15px;border:1px solid #444}
.admin-item{display:flex;justify-content:space-between;padding:5px 0}

@media print {
    body * { visibility: hidden; }
    #print-area, #print-area * { visibility: visible; }
    #print-area { position: absolute; left: 0; top: 0; width: 100%; display: block !important; font-family: monospace; color: #000; }
    .print-logo { font-size: 30px; text-align: center; font-weight: bold; margin-bottom: 5px; }
    .print-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    .print-table th, .print-table td { border-bottom: 1px dashed #000; padding: 5px; text-align: left; font-size: 12px; }
}
#print-area { display: none; }
</style>
</head>
<body>

<div class="container">
  <div class="logo-circle">‚Ç¨</div>
  <h2 id="storeTitle">–ö–ê–°–ê - 1</h2>

  <div class="toggle-line">
    <button id="toggleEUR" class="active" onclick="showBanknotes('EUR')">–ï–≤—Ä–æ –±–∞–Ω–∫–Ω–æ—Ç–∏</button>
    <button id="toggleBGN" onclick="showBanknotes('BGN')">–õ–µ–≤–∞ –±–∞–Ω–∫–Ω–æ—Ç–∏</button>
  </div>

  <div id="banknoteArea"></div>

  <label style="color:var(--eur)">–°—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ (EUR)</label>
  <input id="totalEUR" type="number" step="0.01" placeholder="0.00" class="eur-input">

  <label style="color:var(--bgn)">–ü–ª–∞—Ç–µ–Ω–æ –≤ –ª–µ–≤–∞</label>
  <input id="givenBGN" type="number" step="0.01" placeholder="0.00" class="bgn-input">

  <label style="color:var(--eur)">–ü–ª–∞—Ç–µ–Ω–æ –≤ –µ–≤—Ä–æ</label>
  <input id="givenEUR" type="number" step="0.01" placeholder="0.00" class="eur-input">

  <div class="result-zone">
    <div style="font-size:12px">–†–ï–°–¢–û</div>
    <div id="restTotal" class="result-value">0.00 ‚Ç¨</div>
    <div class="change-toggle">
      <button id="btnGiveEUR" class="active" onclick="setGiveMode('EUR')">–í—Ä—ä—â–∞–º –≤ ‚Ç¨</button>
      <button id="btnGiveBGN" onclick="setGiveMode('BGN')">–í—Ä—ä—â–∞–º –≤ –ª–≤</button>
      <button id="btnGiveMix" onclick="setGiveMode('MIX')">–°–º–µ—Å–µ–Ω–æ</button>
    </div>
    <div id="restDetail" style="color:var(--accent)">(0.00 –ª–≤)</div>
  </div>

  <div class="button-group">
    <button class="action-btn btn-save" onclick="saveOrder()">üíæ –ó–∞–ø–∏—Å</button>
    <button class="action-btn btn-print" onclick="printOrder()">üñ®Ô∏è –ü–µ—á–∞—Ç</button>
  </div>

  <table class="history-table">
    <thead><tr><th>–ß–∞—Å</th><th>–°—É–º–∞ ‚Ç¨</th><th>–ü–ª. ‚Ç¨</th><th>–ü–ª. –ª–≤</th><th>–†–µ—Å—Ç–æ</th></tr></thead>
    <tbody id="histBody"></tbody>
  </table>
</div>

<div id="print-area">
    <div style="border-top:1px dashed #000; margin: 10px 0;"></div>
    <table class="print-table">
        <thead><tr><th>–ß–∞—Å</th><th>–°—É–º–∞ ‚Ç¨</th><th>–ü–∞–ª–µ–Ω–æ ‚Ç¨</th><th>–ü–ª–∞—Ç–µ–Ω–æ –ª–µ–≤–∞</th><th>–†–µ—Å—Ç–æ</th></tr></thead>
        <tbody><tr><td id="ptTime"></td><td id="ptSum"></td><td id="ptPE"></td><td id="ptPL"></td><td id="ptRes"></td></tr></tbody>
    </table>
    <div style="border-top:1px dashed #000; margin: 10px 0;"></div>
    <div style="text-align:center;">–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –í–∏!</div>
</div>

<button class="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è</button>

<div id="adminPanel">
  <h3>–ê–¥–º–∏–Ω –ù–∞—Å—Ç—Ä–æ–π–∫–∏ <button onclick="document.getElementById('adminPanel').style.display='none'" style="float:right; background:none; color:#fff; border:none; font-size:24px;">‚úñ</button></h3>
  
  <div class="admin-box">
    <label>–ò–º–µ –Ω–∞ –æ–±–µ–∫—Ç–∞:</label>
    <div style="display:flex; gap:5px">
        <input id="storeNameInput" type="text" style="text-align:left; background:#eee; font-size:16px">
        <button onclick="saveStoreName()" style="background:var(--ok); color:#fff; border:none; border-radius:6px; padding:0 10px">–ó–∞–ø–∞–∑–∏</button>
    </div>
  </div>

  <div class="admin-box">
    <div class="admin-item" style="border-bottom:1px solid #444; margin-bottom:10px"><strong>–û–¢–ß–ï–¢ –ó–ê –î–ù–ï–°</strong></div>
    <div class="admin-item"><span>–û–±–æ—Ä–æ—Ç –¥–Ω–µ—Å:</span><span style="color:var(--eur)" id="admTotalEUR">0.00 ‚Ç¨</span></div>
    <div class="admin-item"><span>–ü–ª–∞—Ç–µ–Ω–æ –ª–µ–≤–∞:</span><span style="color:var(--bgn)" id="admPaidBGN">0.00 –ª–≤</span></div>
    <div class="admin-item"><span>–ü–ª–∞—Ç–µ–Ω–æ –µ–≤—Ä–æ:</span><span style="color:var(--eur)" id="admPaidEUR">0.00 ‚Ç¨</span></div>
    <div class="admin-item" style="margin-top:10px; border-top:1px dashed #555; padding-top:10px">
        <span>–û–±—â–æ –≤ –ª–≤:</span><span style="color:var(--accent); font-size:18px" id="admLV">0.00 –ª–≤</span>
    </div>
  </div>

  <button onclick="clearDay()" style="width:100%; padding:15px; background:var(--error); color:#fff; border:none; border-radius:6px; font-weight:bold">üóë –ò–ó–¢–†–ò–ô –î–ï–ù–Ø</button>
</div>

<script>
const RATE = 1.95583;
let giveMode = 'EUR';
let daily = { totalEUR:0, paidBGN:0, paidEUR:0, ords:[] };
let todayKey = 'day_' + new Date().toISOString().slice(0,10);

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
function beep(freq=600, ms=150) {
    const o = audioCtx.createOscillator(), g = audioCtx.createGain();
    o.connect(g); g.connect(audioCtx.destination);
    o.frequency.value = freq; g.gain.value = 1.0; 
    o.start(); o.stop(audioCtx.currentTime + ms/1000);
}

function load() {
    const s = localStorage.getItem(todayKey);
    if(s) daily = JSON.parse(s);
    const name = localStorage.getItem('storeName') || '–ö–ê–°–ê - 1';
    document.getElementById('storeTitle').textContent = name;
    document.getElementById('prStoreName').textContent = name;
    document.getElementById('storeNameInput').value = name;
    refl();
}

function saveStoreName() {
    const v = document.getElementById('storeNameInput').value.trim() || '–ö–ê–°–ê - 1';
    localStorage.setItem('storeName', v);
    load(); beep(800, 100);
}

function showBanknotes(cur) {
    document.getElementById('toggleEUR').classList.toggle('active', cur==='EUR');
    document.getElementById('toggleBGN').classList.toggle('active', cur==='BGN');
    const area = document.getElementById('banknoteArea');
    area.innerHTML = '';
    const notes = cur === 'EUR' ? [5,10,20,50,100,200] : [5,10,20,50,100];
    notes.forEach(v => {
        const btn = document.createElement('button');
        btn.className = `money-btn ${cur.toLowerCase()}-${v}`;
        btn.textContent = `${v} ${cur==='EUR'?'‚Ç¨':'–ª–≤'}`;
        btn.onclick = () => {
            const id = cur==='EUR' ? 'givenEUR' : 'givenBGN';
            document.getElementById(id).value = ( (parseFloat(document.getElementById(id).value)||0) + v ).toFixed(2);
            calc();
        };
        area.appendChild(btn);
    });
}

function calc() {
    const t = parseFloat(document.getElementById('totalEUR').value) || 0;
    const b = parseFloat(document.getElementById('givenBGN').value) || 0;
    const e = parseFloat(document.getElementById('givenEUR').value) || 0;
    const restE = (e + b/RATE) - t;
    if (restE < 0) {
        document.getElementById('restTotal').textContent = "---";
        document.getElementById('restDetail').textContent = "–ù–µ–¥–æ—Å—Ç–∏–≥!";
        return null;
    }
    let resTxt = '';
    if(giveMode === 'EUR') resTxt = restE.toFixed(2) + " ‚Ç¨";
    else if(giveMode === 'BGN') resTxt = (restE * RATE).toFixed(2) + " –ª–≤";
    else resTxt = restE.toFixed(2) + " ‚Ç¨ + " + (restE * RATE).toFixed(2) + " –ª–≤";

    document.getElementById('restTotal').textContent = resTxt;
    document.getElementById('restDetail').textContent = "(" + (restE * RATE).toFixed(2) + " –ª–≤)";
    return { t, b, e, resTxt };
}

function setGiveMode(m) {
    giveMode = m;
    document.getElementById('btnGiveEUR').classList.toggle('active', m==='EUR');
    document.getElementById('btnGiveBGN').classList.toggle('active', m==='BGN');
    document.getElementById('btnGiveMix').classList.toggle('active', m==='MIX');
    calc();
}

function printOrder() {
    const c = calc();
    if(!c || c.t <= 0) return alert("–í—ä–≤–µ–¥–µ—Ç–µ —Å—É–º–∞!");
    document.getElementById('ptTime').textContent = new Date().toLocaleTimeString('bg-BG');
    document.getElementById('ptSum').textContent = c.t.toFixed(2);
    document.getElementById('ptPE').textContent = c.e.toFixed(2);
    document.getElementById('ptPL').textContent = c.b.toFixed(2);
    document.getElementById('ptRes').textContent = c.resTxt;
    window.print();
    saveOrder();
}

function saveOrder() {
    const c = calc();
    if(!c || c.t <= 0) return;
    const now = new Date().toLocaleTimeString('bg-BG');
    daily.totalEUR += c.t; daily.paidBGN += c.b; daily.paidEUR += c.e;
    daily.ords.push({time:now, eur:c.t, pEur:c.e, bgn:c.b, rest:c.resTxt});
    localStorage.setItem(todayKey, JSON.stringify(daily));
    beep(900, 200);
    document.getElementById('totalEUR').value = '';
    document.getElementById('givenBGN').value = '';
    document.getElementById('givenEUR').value = '';
    refl(); calc();
}

function refl() {
    document.getElementById('admTotalEUR').textContent = daily.totalEUR.toFixed(2) + " ‚Ç¨";
    document.getElementById('admPaidBGN').textContent = daily.paidBGN.toFixed(2) + " –ª–≤";
    document.getElementById('admPaidEUR').textContent = daily.paidEUR.toFixed(2) + " ‚Ç¨";
    document.getElementById('admLV').textContent = (daily.totalEUR * RATE).toFixed(2) + " –ª–≤";
    document.getElementById('histBody').innerHTML = daily.ords.slice(-5).reverse().map(o => 
        `<tr><td>${o.time}</td><td>${o.eur.toFixed(2)}</td><td>${o.pEur.toFixed(2)}</td><td>${o.bgn.toFixed(2)}</td><td>${o.rest}</td></tr>`
    ).join('');
}

function toggleAdmin() {
    document.getElementById('adminPanel').style.display='block';
}

function clearDay() { if(confirm("–ò–∑—Ç—Ä–∏–≤–∞–Ω–µ?")) { daily={totalEUR:0,paidBGN:0,paidEUR:0,ords:[]}; localStorage.setItem(todayKey, JSON.stringify(daily)); refl(); } }

window.onload = () => { load(); showBanknotes('EUR'); };
document.querySelectorAll('input').forEach(i => i.oninput = calc);
</script>
</body>
</html>