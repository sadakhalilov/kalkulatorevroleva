<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<title>–ï–≤—Ä–æ-–ö–∞—Å–∞ 2026</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%23d4af37%22>‚Ç¨</text></svg>">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
:root{
  --primary:#00264d; --accent:#d4af37; --bg:#f2f2f2; --error:#dc3545; --ok:#28a745;
  --eur:#28a745; --bgn:#007bff;
  --font-size:20px;
}
*{box-sizing:border-box;}
body{margin:0;font-family:Arial, sans-serif;background:var(--bg);display:flex;justify-content:center;padding:8px}
.container{background:#fff;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.15);width:100%;max-width:480px;padding:16px}
.logo-circle { width: 60px; height: 60px; background: var(--primary); color: var(--accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px; font-weight: bold; margin: 0 auto 10px; border: 2px solid var(--accent); }
h2{margin:0 0 15px;text-align:center;color:var(--primary);font-size:24px; font-weight: 800; border-bottom: 2px solid var(--accent); padding-bottom: 5px;}
label{font-weight:600;font-size:12px;display:block;margin-bottom:4px}
input[type=number],input[type=text]{width:100%;font-size:var(--font-size);padding:12px;border:2px solid #ccc;border-radius:6px;text-align:right;margin-bottom:10px;}
.eur-input{border-color:var(--eur);background:#f0fff4}
.bgn-input{border-color:var(--bgn);background:#f0f8ff}
.bgn-hint { font-size: 14px; font-weight: bold; color: var(--bgn); margin-top: -8px; margin-bottom: 10px; text-align: right; }
#banknoteArea{display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:12px}
.money-btn{width:100%;padding:14px;border:none;border-radius:6px;font-weight:bold;font-size:1.1rem;cursor:pointer;transition:0.2s}
.eur-5{background:#b0bec5;} .eur-10{background:#ff8a80;} .eur-20{background:#90caf9;} 
.eur-50{background:#ffcc80;} .eur-100{background:#a5d6a7;} .eur-200{background:#e0e0e0;}
.bgn-5{background:#4fc3f7;} .bgn-10{background:#7986cb;} .bgn-20{background:#3f51b5;color:#fff;}
.bgn-50{background:#ffb74d;} .bgn-100{background:#e57373;}
.toggle-line{display:flex;justify-content:center;gap:8px;margin-bottom:8px}
.toggle-line button{flex:1;padding:10px;border:2px solid;border-radius:6px;background:#fff;font-weight:600;cursor:pointer}
.toggle-line button.active{background:var(--primary);color:#fff}
.result-zone{background:var(--primary);color:#fff;padding:16px;border-radius:8px;text-align:center;margin:12px 0}
.result-value{font-size:38px;font-weight:bold;color:var(--accent)}
.change-toggle{display:flex;justify-content:center;gap:8px;margin:8px 0}
.change-toggle button{flex:1;padding:10px;border:1px solid #fff;border-radius:6px;background:transparent;color:#fff;font-weight:600;cursor:pointer;font-size:12px}
.change-toggle button.active{background:#fff;color:var(--primary)}
.button-group{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
button.action-btn{padding:14px;border:none;border-radius:6px;font-size:15px;font-weight:600;cursor:pointer;color:#fff;}
.btn-save{background:var(--ok)} .btn-print{background:var(--primary)}
.history-table{width:100%;font-size:11px;border-collapse:collapse;margin-top:10px}
.history-table th,.history-table td{border:1px solid #ddd;padding:6px;text-align:center}
.history-table th{background:var(--primary);color:#fff}
.admin-toggle{position:fixed;bottom:10px;right:10px;opacity:.3;background:none;border:none;font-size:24px;cursor:pointer}
#adminPanel{display:none;position:fixed;inset:0;background:rgba(0,0,0,.95);color:#fff;padding:20px;z-index:100;overflow-y:auto}
.stats-card { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid var(--accent); }
.stats-card h4 { margin: 0 0 10px 0; color: var(--accent); text-transform: uppercase; font-size: 14px; }
.stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px; }
@media print { body * { visibility: hidden; } #print-area, #print-area * { visibility: visible; } #print-area { position: absolute; left: 0; top: 0; width: 100%; display: block !important; } }
#print-area { display: none; }
</style>
</head>
<body>

<div class="container">
  <div class="logo-circle">‚Ç¨</div>
  <h2 id="storeTitle">–ö–ê–°–ê - 1</h2>

  <div class="toggle-line">
    <button id="toggleEUR" class="active" onclick="showBanknotes('EUR')">–ï–≤—Ä–æ –±–∞–Ω–∫–Ω–æ—Ç–∏</button>
    <button id="toggleBGN" onclick="showBanknotes('BGN')">–õ–µ–≤–∞ –±–∞–Ω–∫–Ω–æ—Ç–∏</button>
  </div>

  <div id="banknoteArea"></div>

  <label style="color:var(--eur)">–°—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ (EUR)</label>
  <input id="totalEUR" type="number" step="0.01" placeholder="0.00" class="eur-input" oninput="updateBgnHint()">
  <div id="bgnHint" class="bgn-hint">–†–∞–≤–Ω–æ—Å—Ç–æ–π–Ω–æ—Å—Ç: 0.00 –ª–≤</div>

  <label style="color:var(--bgn)">–ü–ª–∞—Ç–µ–Ω–æ –≤ –ª–µ–≤–∞</label>
  <input id="givenBGN" type="number" step="0.01" placeholder="0.00" class="bgn-input" oninput="calculate()">

  <label style="color:var(--eur)">–ü–ª–∞—Ç–µ–Ω–æ –≤ –µ–≤—Ä–æ</label>
  <input id="givenEUR" type="number" step="0.01" placeholder="0.00" class="eur-input" oninput="calculate()">

  <div class="result-zone">
    <div style="font-size:12px">–†–ï–°–¢–û</div>
    <div id="restTotal" class="result-value">0.00 ‚Ç¨</div>
    <div class="change-toggle">
      <button id="btnGiveEUR" class="active" onclick="setGiveMode('EUR')">–í—Ä—ä—â–∞–º –≤ ‚Ç¨</button>
      <button id="btnGiveBGN" onclick="setGiveMode('BGN')">–í—Ä—ä—â–∞–º –≤ –ª–≤</button>
      <button id="btnGiveMix" onclick="setGiveMode('MIX')">–°–º–µ—Å–µ–Ω–æ</button>
    </div>
    <div id="restDetail" style="color:var(--accent)">(0.00 –ª–≤)</div>
  </div>

  <div class="button-group">
    <button class="action-btn btn-save" onclick="saveOrder()">üíæ –ó–∞–ø–∏—Å</button>
    <button class="action-btn btn-print" onclick="printOrder()">üñ®Ô∏è –ü–µ—á–∞—Ç</button>
  </div>

  <table class="history-table">
    <thead><tr><th>–ß–∞—Å</th><th>–°—É–º–∞ ‚Ç¨</th><th>–ü–ª. ‚Ç¨</th><th>–ü–ª. –ª–≤</th><th>–†–µ—Å—Ç–æ</th></tr></thead>
    <tbody id="histBody"></tbody>
  </table>
</div>

<div id="print-area">
    <h3 id="printStoreTitle" style="text-align:center"></h3>
    <p id="printData" style="text-align:center; font-family:monospace"></p>
</div>

<button class="admin-toggle" onclick="toggleAdmin()">‚öôÔ∏è</button>
<div id="adminPanel">
    <h3>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ü–∏—è <button onclick="toggleAdmin()">‚úñ</button></h3>
    
    <div class="stats-card">
        <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ –æ–±–µ–∫—Ç–∞</h4>
        <input id="storeNameInput" type="text" placeholder="–ò–º–µ –Ω–∞ –æ–±–µ–∫—Ç" style="background:#fff; color:#000">
        <button onclick="saveStoreName()" style="width:100%; padding:10px; background:var(--accent); border:none; font-weight:bold; cursor:pointer">–ó–∞–ø–∞–∑–∏ –∏–º–µ</button>
    </div>

    <div class="stats-card">
        <h4>–î–Ω–µ–≤–µ–Ω –æ–±–æ—Ä–æ—Ç (–û–±–æ–±—â–µ–Ω–∏–µ)</h4>
        <div class="stats-grid">
            <div>–û–±—â–æ EUR –≤ –∫–∞—Å–∞—Ç–∞:</div><div id="statTotalEUR" style="color:var(--ok)">0.00 ‚Ç¨</div>
            <div>–û–±—â–æ BGN –≤ –∫–∞—Å–∞—Ç–∞:</div><div id="statTotalBGN" style="color:var(--bgn)">0.00 –ª–≤</div>
            <div>–ë—Ä–æ–π –ø—Ä–æ–¥–∞–∂–±–∏:</div><div id="statCount">0</div>
        </div>
    </div>

    <div class="stats-card">
        <h4>–¢–æ–ø —á–∞—Å–æ–≤–µ –Ω–∞ –ø—Ä–æ–¥–∞–∂–±–∞</h4>
        <div id="statHours" style="font-size:13px">–í—Å–µ –æ—â–µ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏...</div>
    </div>

    <div class="stats-card">
        <h4>–î–∞—Ç–∞ –Ω–∞ –æ—Ç—á–µ—Ç–∞</h4>
        <div id="statDate" style="font-size:16px; font-weight:bold"></div>
    </div>
</div>

<script>
const RATE = 1.95583;
let giveMode = 'EUR';
let salesData = [];
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playSound(type) {
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    if (type === 'success') {
        osc.type = 'sine'; osc.frequency.setValueAtTime(880, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
        osc.start(); osc.stop(audioCtx.currentTime + 0.2);
    } else {
        osc.type = 'sawtooth'; osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
        osc.start(); osc.stop(audioCtx.currentTime + 0.5);
    }
}

document.addEventListener('keydown', function(event) {
    if (event.key === 'Enter') saveOrder();
});

function updateBgnHint() {
    const eur = parseFloat(document.getElementById('totalEUR').value) || 0;
    document.getElementById('bgnHint').innerText = `–†–∞–≤–Ω–æ—Å—Ç–æ–π–Ω–æ—Å—Ç: ${(eur * RATE).toFixed(2)} –ª–≤`;
    calculate();
}

function showBanknotes(currency) {
    const area = document.getElementById('banknoteArea');
    area.innerHTML = '';
    document.getElementById('toggleEUR').classList.toggle('active', currency==='EUR');
    document.getElementById('toggleBGN').classList.toggle('active', currency==='BGN');
    const notes = currency === 'EUR' ? [5, 10, 20, 50, 100, 200] : [5, 10, 20, 50, 100];
    notes.forEach(n => {
        const btn = document.createElement('button');
        btn.className = `money-btn ${currency.toLowerCase()}-${n}`;
        btn.innerText = n + (currency==='EUR' ? ' ‚Ç¨' : ' –ª–≤');
        btn.onclick = () => addMoney(n, currency);
        area.appendChild(btn);
    });
}

function addMoney(val, cur) {
    const input = document.getElementById(cur === 'EUR' ? 'givenEUR' : 'givenBGN');
    input.value = (parseFloat(input.value || 0) + val).toFixed(2);
    calculate();
}

function setGiveMode(m) {
    giveMode = m;
    ['EUR','BGN','MIX'].forEach(x => document.getElementById('btnGive'+x).classList.toggle('active', m===x));
    calculate();
}

function calculate() {
    const totalEUR = parseFloat(document.getElementById('totalEUR').value) || 0;
    const paidEUR = parseFloat(document.getElementById('givenEUR').value) || 0;
    const paidBGN = parseFloat(document.getElementById('givenBGN').value) || 0;
    const totalPaidInEUR = paidEUR + (paidBGN / RATE);
    const restEUR = totalPaidInEUR - totalEUR;
    const resEl = document.getElementById('restTotal');
    const detEl = document.getElementById('restDetail');
    if(restEUR < -0.001) {
        resEl.innerText = "–ù–ï–î–û–°–¢–ò–ì";
        detEl.innerText = (restEUR * RATE).toFixed(2) + " –ª–≤";
        return false;
    }
    if(giveMode === 'EUR') {
        resEl.innerText = restEUR.toFixed(2) + " ‚Ç¨";
        detEl.innerText = "(" + (restEUR * RATE).toFixed(2) + " –ª–≤)";
    } else if(giveMode === 'BGN') {
        resEl.innerText = (restEUR * RATE).toFixed(2) + " –ª–≤";
        detEl.innerText = "(" + restEUR.toFixed(2) + " ‚Ç¨)";
    } else {
        const wholeEUR = Math.floor(restEUR.toFixed(2));
        const centsEUR = restEUR - wholeEUR;
        resEl.innerText = wholeEUR + " ‚Ç¨";
        detEl.innerText = "+ " + (centsEUR * RATE).toFixed(2) + " –ª–≤";
    }
    return true;
}

function updateAdminStats() {
    let totalEUR = 0;
    let totalBGN = 0;
    let hourCounts = {};

    salesData.forEach(sale => {
        totalEUR += sale.paidEUR;
        totalBGN += sale.paidBGN;
        const hour = sale.time.split(':')[0] + ":00";
        hourCounts[hour] = (hourCounts[hour] || 0) + 1;
    });

    document.getElementById('statTotalEUR').innerText = totalEUR.toFixed(2) + " ‚Ç¨";
    document.getElementById('statTotalBGN').innerText = totalBGN.toFixed(2) + " –ª–≤";
    document.getElementById('statCount').innerText = salesData.length;
    document.getElementById('statDate').innerText = new Date().toLocaleDateString('bg-BG');

    const sortedHours = Object.entries(hourCounts).sort((a,b) => b[1] - a[1]);
    document.getElementById('statHours').innerHTML = sortedHours.length > 0 
        ? sortedHours.map(([h, c]) => `<div>${h} —á. ‚Äî ${c} –ø—Ä–æ–¥–∞–∂–±–∏</div>`).join('')
        : "–ù—è–º–∞ –¥–∞–Ω–Ω–∏...";
}

function saveOrder() {
    const totalVal = parseFloat(document.getElementById('totalEUR').value);
    if(!totalVal || totalVal <= 0) return;

    const paidEUR = parseFloat(document.getElementById('givenEUR').value) || 0;
    const paidBGN = parseFloat(document.getElementById('givenBGN').value) || 0;
    const totalPaidInEUR = paidEUR + (paidBGN / RATE);

    if (totalPaidInEUR < totalVal - 0.001) {
        playSound('error'); alert("–ì—Ä–µ—à–∫–∞: –°—É–º–∞—Ç–∞ –Ω–µ –µ —Å—ä–±—Ä–∞–Ω–∞!"); return;
    }

    const now = new Date();
    const sale = {
        time: now.toLocaleTimeString(),
        total: totalVal,
        paidEUR: paidEUR,
        paidBGN: paidBGN,
        rest: document.getElementById('restTotal').innerText
    };
    
    salesData.push(sale);
    playSound('success');

    const row = `<tr><td>${sale.time}</td><td>${sale.total.toFixed(2)}</td><td>${sale.paidEUR.toFixed(2)}</td><td>${sale.paidBGN.toFixed(2)}</td><td>${sale.rest}</td></tr>`;
    document.getElementById('histBody').insertAdjacentHTML('afterbegin', row);
    
    updateAdminStats();
    resetForm();
}

function resetForm() {
    document.getElementById('totalEUR').value = '';
    document.getElementById('givenEUR').value = '';
    document.getElementById('givenBGN').value = '';
    document.getElementById('bgnHint').innerText = '–†–∞–≤–Ω–æ—Å—Ç–æ–π–Ω–æ—Å—Ç: 0.00 –ª–≤';
    document.getElementById('restTotal').innerText = '0.00 ‚Ç¨';
    document.getElementById('restDetail').innerText = '(0.00 –ª–≤)';
    document.getElementById('totalEUR').focus();
}

function printOrder() {
    document.getElementById('printStoreTitle').innerText = document.getElementById('storeTitle').innerText;
    document.getElementById('printData').innerText = `–ß–∞—Å: ${new Date().toLocaleTimeString()}\n–°—É–º–∞: ${document.getElementById('totalEUR').value} ‚Ç¨\n–ü–ª–∞—Ç–µ–Ω–æ: ${document.getElementById('givenEUR').value}‚Ç¨ / ${document.getElementById('givenBGN').value}–ª–≤\n–†–µ—Å—Ç–æ: ${document.getElementById('restTotal').innerText}`;
    window.print();
}

function toggleAdmin() {
    const p = document.getElementById('adminPanel');
    p.style.display = p.style.display === 'block' ? 'none' : 'block';
    updateAdminStats();
}

function saveStoreName() {
    document.getElementById('storeTitle').innerText = document.getElementById('storeNameInput').value;
    toggleAdmin();
}

showBanknotes('EUR');
</script>
</body>
</html>
